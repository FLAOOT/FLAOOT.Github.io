<!DOCTYPE html>
<html>
<head>
    <title>Advanced Minecraft</title>
    <style>
        /* ... предыдущие стили ... */
        #menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }
        .menu-btn {
            margin: 10px;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background: #444;
            border: none;
            color: white;
            border-radius: 5px;
        }
        .menu-btn:hover {
            background: #666;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1>Minecraft Web</h1>
        <button class="menu-btn" onclick="startGame('creative')">Креативный режим</button>
        <button class="menu-btn" onclick="startGame('survival')">Режим выживания</button>
        <button class="menu-btn" onclick="loadWorld()">Загрузить мир</button>
    </div>
    <!-- Остальные элементы остаются как прежде -->
    <script>
        // ... предыдущие настройки ...

        let creativeMode = true;
        const WORLD_SIZE = 100;
        const JUMP_FORCE = 12;
        const FLY_SPEED = 8;

        const blockMaterials = {
            grass: new THREE.MeshPhongMaterial({ color: 0x00ff00 }),
            dirt: new THREE.MeshPhongMaterial({ color: 0x8B4513 }),
            stone: new THREE.MeshPhongMaterial({ color: 0x808080 }),
            wood: new THREE.MeshPhongMaterial({ color: 0x8B5A2B }),
            glass: new THREE.MeshStandardMaterial({ 
                color: 0x00ffff, 
                transparent: true, 
                opacity: 0.7 
            }),
            sand: new THREE.MeshPhongMaterial({ color: 0xFFFF00 }),
            brick: new THREE.MeshPhongMaterial({ color: 0xB22222 }),
            leaves: new THREE.MeshPhongMaterial({ color: 0x228B22, transparent: true, opacity: 0.8 }),
            water: new THREE.MeshStandardMaterial({
                color: 0x0000FF,
                transparent: true,
                opacity: 0.5,
                metalness: 0.7,
                roughness: 0.1
            })
        };

        function startGame(mode) {
            creativeMode = mode === 'creative';
            document.getElementById('menu').style.display = 'none';
            if(creativeMode) {
                moveSpeed = 10;
                GRAVITY = 0;
                player.position.set(0, 20, 0);
            } else {
                moveSpeed = 5;
                GRAVITY = 30;
                player.position.set(0, 5, 0);
            }
            init();
        }

        function updatePlayer(delta) {
            if(!creativeMode) {
                velocity.y -= GRAVITY * delta;
            } else {
                velocity.y = 0;
            }

            const direction = new THREE.Vector3();
            if(keys['w']) direction.z -= 1;
            if(keys['s']) direction.z += 1;
            if(keys['a']) direction.x -= 1;
            if(keys['d']) direction.x += 1;

            if(creativeMode) {
                if(keys[' ']) direction.y += 1;
                if(keys['shift']) direction.y -= 1;
            }

            direction.normalize();
            direction.applyEuler(new THREE.Euler(pitch, yaw, 0));
            
            const speed = creativeMode ? FLY_SPEED : moveSpeed;
            const newPos = player.position.clone()
                .add(direction.multiplyScalar(speed * delta))
                .add(velocity.clone().multiplyScalar(delta));

            const finalPos = creativeMode ? newPos : checkCollisions(newPos);
            player.position.copy(finalPos);
            camera.position.copy(finalPos.add(new THREE.Vector3(0, player.height/2, 0)));

            if(!creativeMode && keys[' '] && canJump) {
                velocity.y = JUMP_FORCE;
                canJump = false;
            }
        }

        function createGround() {
            for(let x = -WORLD_SIZE; x <= WORLD_SIZE; x++) {
                for(let z = -WORLD_SIZE; z <= WORLD_SIZE; z++) {
                    addBlock(x, 0, z, 'grass');
                    for(let y = -1; y >= -3; y--) {
                        addBlock(x, y, z, 'dirt');
                    }
                    if(Math.random() < 0.1) addBlock(x, 1, z, 'sand');
                }
            }
            
            // Генерация деревьев
            for(let i = 0; i < WORLD_SIZE/2; i++) {
                const x = Math.floor(Math.random() * WORLD_SIZE - WORLD_SIZE/2);
                const z = Math.floor(Math.random() * WORLD_SIZE - WORLD_SIZE/2);
                generateTree(x, 1, z);
            }
        }

        function generateTree(x, y, z) {
            // Ствол
            const height = 4 + Math.floor(Math.random() * 3);
            for(let i = 0; i < height; i++) {
                addBlock(x, y + i, z, 'wood');
            }
            
            // Листва
            for(let dx = -2; dx <= 2; dx++) {
                for(let dz = -2; dz <= 2; dz++) {
                    for(let dy = 0; dy < 3; dy++) {
                        if(Math.abs(dx) + Math.abs(dz) + dy !== 4) {
                            addBlock(x + dx, y + height - 1 + dy, z + dz, 'leaves');
                        }
                    }
                }
            }
        }

        // В функции initInventory обновляем список блоков:
        const blockTypes = ['grass', 'dirt', 'stone', 'wood', 'glass', 'sand', 'brick', 'leaves', 'water'];

        // Остальные функции остаются аналогичными, но с учетом новых блоков
    </script>
</body>
</html>
